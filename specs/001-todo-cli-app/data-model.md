# Data Model: Todo In-Memory Python Console Application

**Feature**: 001-todo-cli-app
**Phase**: Phase 1 - Design
**Date**: 2026-01-13

## Purpose

This document defines the complete data model for the Phase I Todo CLI application, including entities, relationships, validation rules, and state transitions.

---

## Entities

### 1. Todo

Represents a single todo item in the system.

**Attributes**:

| Field | Type | Required | Default | Constraints |
|-------|------|----------|---------|-------------|
| `id` | int | Yes | Auto-generated | Unique, positive integer, auto-incremented |
| `title` | str | Yes | - | Non-empty string, max length: unlimited |
| `description` | str | No | Empty string (`""`) | Can be empty, max length: unlimited |
| `completed` | bool | Yes | `False` | Boolean value (True = complete, False = incomplete) |

**Entity Definition** (Python):
```python
from dataclasses import dataclass

@dataclass
class Todo:
    id: int
    title: str
    description: str = ""
    completed: bool = False
```

**Validation Rules**:
1. **Title Validation**:
   - MUST NOT be empty string
   - MUST NOT be only whitespace
   - Leading/trailing whitespace MAY be stripped
   - No maximum length enforced (display may truncate)

2. **ID Validation**:
   - MUST be unique across all todos in current session
   - MUST be positive integer (>= 1)
   - Auto-generated by system, not user-provided

3. **Description Validation**:
   - CAN be empty string
   - No format requirements
   - No maximum length enforced

4. **Completed Validation**:
   - MUST be boolean value
   - Defaults to False on creation
   - Can be toggled true ↔ false

**Specification Traceability**:
- Defined in spec section "Key Entities" (lines 132-138)
- FR-001: Title required
- FR-002: Description optional
- FR-003: Unique ID assignment
- FR-005/FR-006: Completion status tracking

---

## Storage Model

### In-Memory Storage Structure

**Storage Type**: Python dictionary (hash map)

**Structure**:
```python
todos: dict[int, Todo] = {}
```

**Key**: Todo ID (int)
**Value**: Todo instance (object)

**Example**:
```python
{
    1: Todo(id=1, title="Buy groceries", description="Milk, eggs", completed=False),
    2: Todo(id=2, title="Call dentist", description="", completed=True),
    3: Todo(id=3, title="Finish report", description="Q4 summary", completed=False)
}
```

**ID Generation**:
- Global counter variable: `next_id`
- Starts at 1
- Increments after each todo creation
- Never reuses IDs (even after deletion)

**Storage Operations**:

| Operation | Complexity | Implementation |
|-----------|----------|----------------|
| Add | O(1) | `todos[next_id] = Todo(...)` |
| Get by ID | O(1) | `todos.get(id)` |
| Update | O(1) | `todos[id].field = value` |
| Delete | O(1) | `del todos[id]` |
| List All | O(n) | `list(todos.values())` |

**Specification Traceability**:
- FR-010: In-memory storage only
- TC-004: No file or database persistence
- AC-004: Data lost on exit acceptable

---

## State Transitions

### Todo Completion Status

**States**:
1. **Incomplete** (`completed = False`) - default state
2. **Complete** (`completed = True`) - user marked as done

**Transitions**:

```
         Mark Complete
Incomplete ──────────────> Complete
    <───────────────
      Mark Incomplete
```

**Valid Transitions**:
- Incomplete → Complete (via "Mark Complete" operation)
- Complete → Incomplete (via "Mark Incomplete" operation)
- Incomplete → Incomplete (no change)
- Complete → Complete (no change)

**Invalid Transitions**: None (all transitions allowed)

**State Transition Rules**:
1. User can toggle status any number of times
2. Status changes are immediate and reflected in view
3. Status does not affect update or delete operations
4. No state history tracked (only current state matters)

**Specification Traceability**:
- FR-005: Mark complete
- FR-006: Mark incomplete
- User Story 2: Status tracking

---

## Data Lifecycle

### Creation
1. User provides title (required) and description (optional)
2. System validates title (non-empty)
3. System generates unique ID
4. System creates Todo instance with `completed=False`
5. System adds Todo to storage

### Reading
1. User requests view (all todos or specific ID)
2. System retrieves from storage
3. System formats and displays

### Update
1. User provides todo ID and new value(s)
2. System validates ID exists
3. System validates new values
4. System updates Todo fields in storage

### Deletion
1. User provides todo ID
2. System validates ID exists
3. System removes from storage
4. ID is not reused

### Session End
1. User exits application
2. All in-memory data lost
3. No persistence or cleanup needed

**Specification Traceability**:
- FR-001 to FR-009: CRUD operations
- AC-004: No persistence

---

## Data Constraints

### Global Constraints
- No persistence (in-memory only)
- No shared state across sessions
- No authentication (all todos visible to any user)
- No relationships between todos (flat structure)

### Performance Constraints
- System MUST handle 100 todos (SC-007)
- Dictionary storage efficient for this scale
- No indexing or optimization needed

### Capacity Constraints
- Limited by Python process memory
- Practical limit: thousands of todos
- Spec requirement: 100 todos

---

## Entity Relationships

**Relationships**: None

This is a flat data model with no relationships:
- Todos are independent entities
- No parent-child relationships
- No references between todos
- No user ownership (Phase I has no auth)

**Future Phases**:
- Phase II may introduce: User → Todo (one-to-many)
- Phase III may introduce: Conversation → Todo context
- Phase IV/V: No new relationships anticipated

---

## Validation Summary

### Input Validation

| Field | Validation Rule | Error Message |
|-------|----------------|---------------|
| Title | Non-empty after strip | "Title cannot be empty" |
| Description | None (always valid) | N/A |
| ID (user input) | Exists in storage | "Todo ID not found" |
| ID (user input) | Valid integer | "Please enter a valid number" |
| Menu choice | Valid option (1-6) | "Invalid option, please try again" |

### Business Rule Validation

1. **Uniqueness**: IDs MUST be unique (enforced by auto-increment)
2. **Existence**: Operations on ID MUST fail gracefully if not found
3. **Immutability**: ID MUST NOT change after creation
4. **Defaults**: New todos default to incomplete status

---

## Data Display Format

### List View Format

**All Todos Display**:
```
================================================================================
                              TODO LIST
================================================================================
ID | Title                          | Description         | Status
--------------------------------------------------------------------------------
1  | Buy groceries                  | Milk, eggs, bread   | Incomplete
2  | Call dentist                   |                     | Complete
3  | Finish report                  | Q4 summary          | Incomplete
================================================================================
Total: 3 todos
```

**Empty List Display**:
```
================================================================================
                              TODO LIST
================================================================================
No todos found. Add your first todo to get started!
================================================================================
```

**Status Indicators**:
- Incomplete: Display as "Incomplete" or "[ ]"
- Complete: Display as "Complete" or "[✓]"

**Truncation** (if needed):
- Title: Truncate at 30 chars with "..."
- Description: Truncate at 20 chars with "..."
- Full values stored, only display truncated

---

## Constitutional Compliance

- [x] **Phase I Requirements**: In-memory only, no persistence
- [x] **No Databases**: Dictionary storage in Python process
- [x] **No Files**: No file-based storage
- [x] **No External Dependencies**: Standard library dataclasses only
- [x] **Simplicity**: Flat structure, no premature abstraction

---

## Specification Traceability Matrix

| Spec Requirement | Data Model Element |
|-----------------|-------------------|
| FR-001: Add todo with title | Todo.title (required) |
| FR-002: Optional description | Todo.description (optional, default="") |
| FR-003: Unique identifier | Todo.id (auto-generated, unique) |
| FR-004: Display ID, title, status | All Todo fields displayed |
| FR-005: Mark complete | Todo.completed = True |
| FR-006: Mark incomplete | Todo.completed = False |
| FR-007: Update title | Todo.title mutable |
| FR-008: Update description | Todo.description mutable |
| FR-009: Delete todo | Remove from storage dict |
| FR-010: In-memory only | dict[int, Todo] storage |
| SC-007: Handle 100 todos | Dictionary scales to 100+ |

---

**Data Model Phase Complete**: All entities, storage, and validation defined ✅
**Ready for**: Contract generation (N/A for CLI) and quickstart documentation
